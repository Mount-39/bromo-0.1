$(function(){var e=function(){var e=$("#page"),t=$("<div/>",{id:"login-form"}).appendTo(e),a=$("<fieldset/>",{}).appendTo(t),o=$("<form/>",{}).appendTo(a);$("<h1/>",{text:"Bromo"}).appendTo(o),$("<p/>",{text:"Chat with your friends become more easier than ever."}).appendTo(o),$("<input/>").attr({type:"email",required:"true",placeholder:"Email",autocomplete:"off"}).appendTo(o),$("<input/>").attr({type:"password",required:"true",placeholder:"Password",autocomplete:"off"}).appendTo(o);var p=$("<input/>").attr({value:"Sign In",type:"submit"}).appendTo(o);o.submit(function(t){t.preventDefault(),$.ajax({type:"POST",url:"/authorization",data:{email:$("[type = email]").val(),password:$("[type = password]").val()},success:function(t){$("[class = error]").remove(),1==t?(e.empty(),chat()):p.before($("<div/>",{"class":"error",text:"Email or Password is incorrect!"}))}})});var r=$("<div/>",{id:"register"}).appendTo(t);$("<h5/>",{text:"Don't have an Account?"}).appendTo(r),$("<button/>",{"class":"btn",click:function(){o.remove(),r.remove();var p=$("<form/>",{}).appendTo(a),n=$("<div/>",{id:"register"}).appendTo(t);$("<input/>").attr({type:"email",required:"true",placeholder:"Email",autocomplete:"off"}).appendTo(p),$("<input/>").attr({type:"password",required:"true",placeholder:"Password",autocomplete:"off"}).appendTo(p),$("<button/>",{"class":"reg",click:function(){$.ajax({type:"POST",url:"/registration",data:{email:$("[type = email]").val(),password:$("[type = password]").val(),username:$("[type = text]").val()},success:function(t){n.empty(),console.log(t.result),1==t.result&&(e.empty(),chat()),t.error.indexOf("E11000")>=0?$("<h5/>",{text:"This username is already exists!"}).appendTo(n):$("<h5/>",{text:t.error}).appendTo(n),console.log(t),main()}})}}).text("Create").appendTo(p),$("[type = email]").before($("<input/>",{type:"text",required:"true",method:"get",placeholder:"Name",autocomplete:"off"})),$("[type = text]").addClass("reg"),$("[type = email]").addClass("reg"),$("[type = password]").addClass("reg"),p.submit(function(e){e.preventDefault()})}}).text("Create Account Now").appendTo(r)};e()});var chat=function(){function e(e,t){$("div#chat ul").append($("li").addClass(t).text(e))}function t(t){socket.emit("message",t),e(t.val(),"outbox"),t.val("")}function a(e){var t=$("<header/>",{"class":"menu"});return $("<h1/>",{text:"Bromo"}).appendTo(t),e.append(t),$("<div/>",{id:"people"}).appendTo(e),this}function o(e){$("<header/>",{"class":"title",text:"Main chat"}).appendTo(e);var a=$("<div/>",{id:"chat"});$("<ul/>",{}).appendTo(a),e.append(a);var o=$("<div/>",{id:"form"});return $("<input/>").attr({id:"message",type:"text",autocomplete:"off"}).appendTo(o),$("<button/>",{text:"Send",click:function(){t($("#message"))}}).appendTo(o),e.append(o),this}var p=$("#page"),r=$("<aside/>",{id:"sidebar"}).appendTo(p),n=$("<div/>",{id:"view"}).appendTo(p);a(r),o(n),socket.on("message",function(t){e(t,"inbox")})};